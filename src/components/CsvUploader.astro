---

---

<section class="space-y-6">
    <header class="space-y-2">
        <h2 class="text-xl font-semibold text-slate-900">
            Importer un fichier CSV
        </h2>
        <p class="text-sm text-slate-600">
            Sélectionnez votre fichier, mappez les colonnes, puis prévisualisez
            les 20 premières lignes.
        </p>
    </header>

    <div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
        <div
            class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between"
        >
            <div class="space-y-1">
                <label for="csv-file" class="text-sm font-medium text-slate-800"
                    >Fichier CSV</label
                >
                <input
                    id="csv-file"
                    type="file"
                    accept=".csv,text/csv"
                    class="block w-full cursor-pointer rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 file:mr-4 file:rounded-md file:border-0 file:bg-emerald-50 file:px-3 file:py-2 file:text-emerald-700 hover:file:bg-emerald-100"
                />
                <p id="csv-file-info" class="text-xs text-slate-500">
                    Aucun fichier sélectionné.
                </p>
            </div>

            <div class="flex items-center gap-3">
                <button
                    id="btn-reset"
                    type="button"
                    class="rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 transition hover:bg-slate-50 disabled:opacity-50"
                    disabled>Réinitialiser</button
                >
                <button
                    id="btn-preview"
                    type="button"
                    class="rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-emerald-600 disabled:opacity-50"
                    disabled>Prévisualiser 20 lignes</button
                >
                <button
                    id="btn-import"
                    type="button"
                    class="rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-slate-800 disabled:opacity-50"
                    disabled>Importer</button
                >
            </div>
        </div>

        <div id="mapping" class="mt-6 hidden">
            <p class="mb-3 text-sm font-medium text-slate-800">
                Mapping des colonnes
            </p>
            <div class="grid gap-4 sm:grid-cols-2 md:grid-cols-3">
                <div>
                    <label class="block text-xs font-medium text-slate-600"
                        >date</label
                    >
                    <select
                        data-map-target="date"
                        class="mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900"
                    ></select>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-600"
                        >amount</label
                    >
                    <select
                        data-map-target="amount"
                        class="mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900"
                    ></select>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-600"
                        >description</label
                    >
                    <select
                        data-map-target="description"
                        class="mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900"
                    ></select>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-600"
                        >counterparty</label
                    >
                    <select
                        data-map-target="counterparty"
                        class="mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900"
                    ></select>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-600"
                        >budget_category</label
                    >
                    <select
                        data-map-target="budget_category"
                        class="mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900"
                    ></select>
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-600"
                        >type</label
                    >
                    <select
                        data-map-target="type"
                        class="mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900"
                    ></select>
                </div>
            </div>
            <p id="delimiter-info" class="mt-3 text-xs text-slate-500"></p>
        </div>

        <div id="preview" class="mt-6 hidden">
            <p class="mb-3 text-sm font-medium text-slate-800">
                Prévisualisation (20 premières lignes mappées)
            </p>
            <div class="overflow-x-auto rounded-xl border border-slate-200">
                <table class="min-w-full divide-y divide-slate-200 text-sm">
                    <thead class="bg-slate-50">
                        <tr>
                            <th
                                class="px-3 py-2 text-left font-semibold text-slate-700"
                                >date</th
                            >
                            <th
                                class="px-3 py-2 text-left font-semibold text-slate-700"
                                >amount</th
                            >
                            <th
                                class="px-3 py-2 text-left font-semibold text-slate-700"
                                >description</th
                            >
                            <th
                                class="px-3 py-2 text-left font-semibold text-slate-700"
                                >counterparty</th
                            >
                            <th
                                class="px-3 py-2 text-left font-semibold text-slate-700"
                                >budget_category</th
                            >
                            <th
                                class="px-3 py-2 text-left font-semibold text-slate-700"
                                >currency</th
                            >
                            <th
                                class="px-3 py-2 text-left font-semibold text-slate-700"
                                >type</th
                            >
                        </tr>
                    </thead>
                    <tbody
                        id="preview-body"
                        class="divide-y divide-slate-200 bg-white"></tbody>
                </table>
            </div>
        </div>

        <p id="uploader-feedback" class="mt-4 min-h-[1.25rem] text-sm"></p>
    </div>
</section>

<script type="module" src="/src/scripts/csv-uploader.ts"></script>
